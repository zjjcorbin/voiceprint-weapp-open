<view class="container">
  <!-- é¡¶éƒ¨åŒºåŸŸ -->
  <view class="header">
    <text class="title">å£°çº¹éªŒè¯</text>
    <text class="subtitle">è¯·è¯´å‡ºä»»æ„å†…å®¹è¿›è¡Œèº«ä»½éªŒè¯</text>
  </view>

  <!-- ä¸»è¦éªŒè¯åŒºåŸŸ -->
  <view class="verify-section">
    <!-- éªŒè¯çŠ¶æ€æ˜¾ç¤º -->
    <view class="status-display">
      <view class="status-icon {{verificationStatus}}">
        <text class="icon-text">{{getStatusIcon()}}</text>
      </view>
      <text class="status-title">{{getStatusTitle()}}</text>
      <text class="status-desc">{{getStatusDesc()}}</text>
    </view>

    <!-- å½•éŸ³æ§åˆ¶åŒºåŸŸ -->
    <view class="recording-area">
      <!-- å½•éŸ³æŒ‰é’® -->
      <view class="record-btn-container">
        <button 
          class="record-btn {{isRecording ? 'recording' : ''}}" 
          bindtouchstart="startRecording" 
          bindtouchend="stopRecording"
          disabled="{{processing}}"
        >
          <view class="record-btn-inner">
            <text class="record-icon">{{isRecording ? 'â¸' : 'ğŸ¤'}}</text>
          </view>
        </button>
      </view>

      <!-- å½•éŸ³çŠ¶æ€ -->
      <view class="recording-status">
        <text class="status-text" wx:if="{{!isRecording && !hasRecording}}">
          æŒ‰ä½ä¸‹æ–¹æŒ‰é’®å¼€å§‹å½•éŸ³
        </text>
        <text class="status-text recording" wx:if="{{isRecording}}">
          æ­£åœ¨å½•éŸ³...
        </text>
        <text class="status-text processing" wx:if="{{processing}}">
          æ­£åœ¨è¯†åˆ«...
        </text>
      </view>

      <!-- å½•éŸ³æ—¶é•¿ -->
      <view class="recording-duration" wx:if="{{isRecording}}">
        <text class="duration">{{formatTime(recordingDuration)}}</text>
      </view>

      <!-- éŸ³é¢‘æ³¢å½¢ -->
      <view class="waveform" wx:if="{{isRecording}}">
        <view class="wave-bars">
          <view class="wave-bar" wx:for="{{waveformData}}" wx:key="index" 
                style="height: {{item}}rpx; animation-delay: {{index * 0.05}}s;"></view>
        </view>
      </view>

      <!-- æç¤ºæ–‡æœ¬ -->
      <view class="recording-tips">
        <text class="tip-text">{{getRecordingTip()}}</text>
      </view>
    </view>

    <!-- éªŒè¯ç»“æœ -->
    <view class="result-section" wx:if="{{verificationResult}}">
      <view class="result-card {{verificationResult.success ? 'success' : 'fail'}}">
        <view class="result-header">
          <text class="result-title">{{verificationResult.success ? 'éªŒè¯æˆåŠŸ' : 'éªŒè¯å¤±è´¥'}}</text>
          <text class="result-confidence" wx:if="{{verificationResult.success}}">
            ç½®ä¿¡åº¦ï¼š{{verificationResult.confidence * 100}}%
          </text>
        </view>
        
        <view class="result-details" wx:if="{{verificationResult.success}}">
          <view class="detail-item">
            <text class="detail-label">è¯†åˆ«ç”¨æˆ·ï¼š</text>
            <text class="detail-value">{{verificationResult.userName}}</text>
          </view>
          <view class="detail-item">
            <text class="detail-label">éªŒè¯æ—¶é—´ï¼š</text>
            <text class="detail-value">{{verificationResult.verifyTime}}</text>
          </view>
        </view>

        <view class="result-actions">
          <button class="retry-btn" bindtap="retry">é‡æ–°éªŒè¯</button>
          <button class="close-btn" bindtap="closeResult">å…³é—­</button>
        </view>
      </view>
    </view>
  </view>

  <!-- å†å²è®°å½• -->
  <view class="history-section" wx:if="{{verificationHistory.length > 0}}">
    <view class="section-header">
      <text class="section-title">æœ€è¿‘éªŒè¯è®°å½•</text>
      <text class="more-btn" bindtap="viewAllHistory">æŸ¥çœ‹å…¨éƒ¨</text>
    </view>
    
    <view class="history-list">
      <view class="history-item {{item.success ? 'success' : 'fail'}}" 
            wx:for="{{verificationHistory}}" wx:key="id">
        <view class="history-time">{{item.time}}</view>
        <view class="history-result">
          <text class="result-text">{{item.success ? 'æˆåŠŸ' : 'å¤±è´¥'}}</text>
          <text class="confidence-text" wx:if="{{item.success}}">
            {{item.confidence * 100}}%
          </text>
        </view>
      </view>
    </view>
  </view>

  <!-- å¿«æ·æ“ä½œ -->
  <view class="quick-actions">
    <button class="action-btn register" bindtap="goToRegister" wx:if="{{!isRegistered}}">
      <text>æ³¨å†Œå£°çº¹</text>
    </button>
    <button class="action-btn meeting" bindtap="goToMeeting">
      <text>ä¼šè®®ç®¡ç†</text>
    </button>
  </view>
</view>

<!-- å½•éŸ³é®ç½© -->
<view class="recording-overlay" wx:if="{{isRecording}}">
  <view class="overlay-content">
    <view class="recording-visual">
      <view class="pulse-ring"></view>
      <view class="pulse-ring delay-1"></view>
      <view class="pulse-ring delay-2"></view>
      <view class="recording-icon">ğŸ¤</view>
    </view>
    <text class="overlay-text">æ­£åœ¨å½•éŸ³...</text>
    <text class="overlay-tip">æ¾å¼€ç»“æŸå½•éŸ³</text>
  </view>
</view>